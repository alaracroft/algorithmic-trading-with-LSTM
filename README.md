# algoritmic-trading-with-LSTM
Прогнозирование поведения фондовых рынков является объектом исследования в различных отраслях на протяжении десятков лет. Учитывая всю сложность и хаотичность динамики цен на акции, найти единственно верное решение является невыполнимой задачей. Из-за огромного количества факторов, оказывающих влияние на рынок, и наличия элемента случайности еще никто не смог дать точного прогноза. Однако с каждым годом встречается все больше работ, в которых авторы пытаются приблизиться к решению.

Вдохновишись гипотезой адаптивных рынков, я решил попробовать создать нетипичную статегию торговли с ипользованием LSTM.

В качестве примера были взяты данные компании "3M". Данные были взяты с сайта финам https://www.finam.ru/profile/akcii-usa-bats/3m-co/export/

В качестве признаком использовались лагнутные на 1 период технические индикаторы, сгенерированные библиотекой TA-lib

Стратегия была нацелена на поиск оптимальных моментов продажи и покупки акции. Вся задача была сведена к многоклассовой классификации с тремя классами BUY, SELL, HOLD. Для маркировки был проведен анализ локальных минимумов и максимумов.

![alt text](https://sun1-83.userapi.com/ZNwHaD_I1cWQoCYe1QX9UKkRmqf1XLRPY5h9oA/u3JKMQd7YmM.jpg)

Распределение по классам выглядит следующим образом

![alt text](https://sun1-97.userapi.com/yOb6NMGB_yT2eVPrUhSdTBaaUnEPH4xbC07HKA/gN85QM_e3Wc.jpg)

Результаты интерепертируются, что модель в дейтсвительности обучается и способна различать минорные и доминирующий классы, однако не всегда способна побить бейзлайны более простых моделей

              precision    recall  f1-score   support

           0      0.516     0.717     0.600      2187
           1      0.245     0.111     0.153      1019
           2      0.247     0.175     0.205      1013



        accuracy                          0.440      4219
       macro avg      0.336     0.334     0.319      4219
    weighted avg      0.386     0.440     0.397      4219
    
В будущем стоит рассмотреть варинат с большим количестовом классом. К примеру разбивать не на действия, а на состояния рынка: подъем, спад, повышенный спрос, стагнация. А так же использовать ансамбли моделей для получения лучшего результата. Когда модель станет более адекватной стоит сравнить ее доходность с доходностями традционных инвестиционных стратегий, а так же сравнить результаты межжду акциями различных компаний.
